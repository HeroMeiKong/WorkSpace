<!-- pages/preview/preview.wxml -->
<view class="user-page {{models}}">
  <backTitle></backTitle>
  <view class="wrappers" style="visibility:{{showwrappers}}">
    <view class="preview">
      <movable-area class="screenshot" style="display:{{showVideo.notvideo}};width:{{picsize.width}}px;height:{{picsize.height}}px;">
        <block wx:for="{{movableviewNum}}" wx:key="*this">
          <movable-view id="{{item.id}}" style="width: {{item.width}}px;height: {{item.height}}px;display:{{item.show}}" direction="all" bindchange="moveMovableView" damping="200">
            <view class="wrapperimage" style="display:{{item.display}};transform:rotate({{item.rotate}}deg)">
              <image id="top{{item.id}}" class="flextoppic" style="display:{{hiddenpaster}}" src="../../assets/images/4shanchu@2x.png" catch:tap="cancelMovableView"></image>
              <image id="pic{{item.id}}" src="{{item.pic}}" bind:tap="showMovableView"></image>
              <image id="bottom{{item.id}}" class="flexbottompic" style="display:{{hiddenpaster}}" src="../../assets/images/4lashen@2x.png" catch:touchstart="getStartLocation" catch:touchmove="moveLocation" catch:touchend="endLocation"></image>
              <image id="rotate{{item.id}}" class="flexrotatepic" style="display:{{hiddenpaster}}" src="../../assets/images/4lashen@2x.png" catch:touchstart="startRotate" catch:touchmove="moveRotate" catch:touchend="endRotate"></image>
            </view>
          </movable-view>
        </block>
      </movable-area>
      <view class="previewpic">
        <image style="width:{{picsize.width}}px;height:{{picsize.height}}px;" src="{{previewpic}}"></image>
      </view>
      <!-- <view class="cover" style="display:{{showcover}}"></view>遮罩层 -->
    </view>
    <view class="bottom">
      <view class="option" style="display:{{showoption}};">
        <view class="next" catch:tap="nextStep">
          下一步
          <image src="../../assets/images/4jt5@2x.png"></image>
        </view>
        <!-- <view class="section" catch:tap="filter">
          <image class="img" src="../../assets/images/4filter.png"></image>
          <text class="">滤镜</text>
        </view> -->
        <view class="section" catch:tap="paster">
          <image class="img" src="../../assets/images/4tiezhi@2x.png"></image>
          <text class="">贴纸</text>
        </view>
        <view class="section" catch:tap="music">
          <image class="img" src="../../assets/images/4yinyue@2x.png"></image>
          <text class="">音乐</text>
        </view>
      </view>
      <!-- <view class="filter" style="display:{{showfilter}};">
        <view class="ischosewrapper">
          <view class="ischose" catch:tap="cancelFilter">取消</view>
          <view class="ischose" catch:tap="goHomeFilter">确定</view>
        </view>
        <view class="choseinner">
          <swiper display-multiple-items='5' duration="1000">
            <block wx:for="{{filters}}" wx:key="*this">
              <swiper-item>
                <view class="{{item.filterdiv}}" catch:tap="choseFilter">
                  <image id="{{item.id}}" class="filterimage" src="{{item.chose}}"></image>
                  <text class="filtertext">{{item.name}}</text>
                </view>
              </swiper-item>
            </block>
          </swiper>
        </view>
      </view> -->
      <view class="paster" style="display:{{showpaster}};">
        <view class="ischosewrapper">
          <view class="ischose" catch:tap="cancelPaster">取消</view>
          <view class="ischose" catch:tap="goHomePaster">确定</view>
        </view>
        <view class="choseinner">
          <swiper id="pasterId" display-multiple-items='5' current="{{pasterbegin}}" duration="1000" skip-hidden-item-layout="{{true}}" bind:touchstart="pasterSwiperStart" bind:touchend="pasterSwiperEnd">
            <block wx:for="{{pasters}}" wx:key="*this">
              <swiper-item>
                <view class="pasterdiv">
                  <image id="{{item.id}}" class="pasterimage" src="{{item.icon}}" catch:tap="chosePasterPic"></image>
                </view>
              </swiper-item>
            </block>
          </swiper>
          <view class="paster_section">
            <swiper display-multiple-items='5' duration="1000" skip-hidden-item-layout="{{true}}">
              <block wx:for="{{pasters_type}}" wx:key="*this">
                <swiper-item>
                  <view id='pasters_type{{item.id}}' class="{{item.chosethispaster}}" catch:tap="chosePaster">
                    <text class="font">{{item.sticker_type_name}}</text>
                    <view class="line"></view>
                  </view>
                </swiper-item>
              </block>
            </swiper>
          </view>
        </view>
      </view>
      <view class="music" style="display:{{showmusic}};">
        <view class="ischosewrapper">
          <view class="ischose" catch:tap="cancelMusic">取消</view>
          <view class="ischose" catch:tap="goHomeMusic">确定</view>
        </view>
        <view class="choseinner">
          <view class="musiclist" style="display:{{showmusiclist}}">
            <swiper display-multiple-items='5' vertical="true" current="{{musicbegin}}" duration="1000">
              <block wx:for="{{showmusiclists}}" wx:key="*this">
                <swiper-item>
                  <view id="{{item.id}}" class="musiclistdiv" bindtap="pickMusic">
                    <!-- <view id="left{{item.id}}" class="musiclistleftwrapper" bindtap="playmusic"> -->
                      <view id="left{{item.id}}" class="musiclistleftwrapper">
                      <view class="musiclistleft">
                        <image class="playmusic" src="{{item.leftimg}}"></image>
                      </view>
                      <view class="musiclistcenter">
                        <text class="musicname">{{item.music_name}}</text>
                      </view>
                    </view>
                    <view class="musiclistright">
                      <!-- <image id="right{{item.id}}" class="addmusic" src="{{item.rightimg}}" bindtap="addmusic"></image> -->
                      <image id="right{{item.id}}" class="addmusic" src="{{item.rightimg}}"></image>
                    </view>
                  </view>
                </swiper-item>
              </block>
            </swiper>
          </view>
          <swiper display-multiple-items='5' duration="1000">
            <block wx:for="{{musics}}" wx:key="*this">
              <swiper-item>
                <view id="{{item.id}}" class="musicdiv" catch:tap="choseMusic">
                  <image class="musicimage" src="{{item.pic}}"></image>
                  <text class="musictext">{{item.music_type_name}}</text>
                </view>
              </swiper-item>
            </block>
          </swiper>
        </view>
      </view>
    </view>
  </view>
  <view class="publish {{models}}" style="display:{{showpublish}}">
    <view class="videowrapper">
      <video id="myVideo1" bindplay="videoAutoPlay" show-center-play-btn="{{false}}" bindended="videoend" objectFit="contain" controls="{{false}}" src="{{tempFilePath}}" style="display:{{showVideos}};width:{{previewsize.width}}px;height:{{previewsize.height}}px" muted="{{videomuted}}" autoplay="{{false}}">
        <block wx:for="{{publish}}">
          <cover-image class="coverimage" src="{{item.pic}}" style="width:{{item.width}}px;height:{{item.height}}px;left:{{item.x}}px;top:{{item.y}}px;transform:rotate({{item.rotate}}deg)"></cover-image>
        </block>
        <cover-view class="playimg" catch:tap="pauseThis">
          <cover-image style="display:{{showpause}}" src="../../assets/images/4play1.png" catch:tap="playThis"></cover-image>
        </cover-view>
      </video>
    </view>
    <view class="textcontent" style="display:{{showtextcontent}}">
    <textarea bindblur="bindTextAreaBlur" class="introduce" placeholder="请输入简介...(选填,最多30字！)" maxlength="30" bindinput="bindTextAreaInput"></textarea>
      <view class="topic" catch:tap="choseTopic">
        <view class="topicinner">
          <image class="topicinnerpic" src="../../assets/images/4huati2@2x.png" />
          <font>{{topic}}</font>
        </view>
      </view>
      
    </view>
    <view class="topictype" style="display:{{showtopictype}}">
      <view class="topictype_top">
        <cover-view class="topictype_line"></cover-view>
      </view>
      <view class="topictype_bottom">
        <swiper display-multiple-items='9' vertical="true" duration="1000">
          <block wx:for="{{topics}}" wx:key="*this">
            <swiper-item>
              <view class="topictype_box" id="{{item.id}}" catch:tap="choseThisTopic">
                <image class="topictype_pic" src="{{item.pic}}"></image>
                <view class="topictype_text">{{item.sub_title}}</view>
              </view>
            </swiper-item>
          </block>
        </swiper>
      </view>
    </view>
    <!-- <view class="bottom_option" style="display:{{showsure}}">
      <view class="back" catch:tap="cancelUploadContent">返回上一步</view>
      <view class="sure" catch:tap="uploadContent">确认发布</view>
    </view> -->
    <!-- 春节样式 -->
    <view class="bottom_option" style="display:{{showsure}}">
      <view class="back" catch:tap="cancelUploadContent"><image src="../../assets/images/4fanhui@2x.png" />返回上一步</view>
      <view class="sure" catch:tap="uploadContent"><image src="../../assets/images/4fabu@2x.png" />确认发布</view>
    </view>
  </view>
  <cover-view class="overcover" style="display:{{showovercover}}"></cover-view>
  <view class="submissionwrapper" style="display:{{showsubmission}}">
    <cover-view class="submission" wx:if="{{compose_success}}">
      <cover-image class="submissioninner" src="https://s-js.sports.cctv.com/host/image/2018/12/27/15458823882843.png"></cover-image>
      <cover-image src="../../assets/images/4success1@2x.png" class="compose_img"></cover-image>
      <cover-view class="submission_success">
        <cover-view class="submission_top">
          <cover-view class="submission_title">视频提交成功</cover-view>
          <cover-view class="submission_texts">审核预计需要时间<text decode="{{true}}">&lt;</text>1小时</cover-view>
          <cover-view class="submission_text">请在个人中心查看审核进度</cover-view>
        </cover-view>
        <cover-view class="submission_bottom">
          <cover-view class="submission_button"><cover-image src="https://s-js.sports.cctv.com/host/resource/future/3return@2x_0.png" catch:tap="successBackHome"></cover-image></cover-view>
          <cover-view class="submission_button"><cover-image src="https://s-js.sports.cctv.com/host/resource/future/3schedule@2x_0.png" catch:tap="checkProgress"></cover-image></cover-view>
        </cover-view>
      </cover-view>
    </cover-view>
    <cover-view class="submission submission_fail_color" wx:if="{{!compose_success}}">
      <cover-image class="submissioninner" src="https://s-js.sports.cctv.com/host/image/2018/12/27/15458823882843.png"></cover-image>
      <cover-view class="submission_fail_top">
        <cover-image src="../../assets/images/3failure@2x.png" class="compose_fail_img"></cover-image>
      </cover-view>
      <cover-view class="submission_fail">
        <cover-view class="submission_top">
          <cover-view class="submission_title submission_title_color">提交失败</cover-view>
          <cover-view class="submission_text submission_text_color">网络原因提交失败，请重试！</cover-view>
        </cover-view>
        <cover-view class="submission_bottom">
          <cover-view class="submission_button"><cover-image src="../../assets/images/3determine@2x.png" class="submission_bottom_img"  catch:tap="returnSubmit"></cover-image></cover-view>
        </cover-view>
      </cover-view>
    </cover-view>
  </view>
</view>