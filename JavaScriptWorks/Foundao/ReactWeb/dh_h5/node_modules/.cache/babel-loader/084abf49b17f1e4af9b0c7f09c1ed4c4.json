{"ast":null,"code":"import _classCallCheck from \"/Users/HeroMeiKong/JobSpace/JavaScriptWorks/foundao/ReactWeb/dh_h5/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/HeroMeiKong/JobSpace/JavaScriptWorks/foundao/ReactWeb/dh_h5/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/HeroMeiKong/JobSpace/JavaScriptWorks/foundao/ReactWeb/dh_h5/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/HeroMeiKong/JobSpace/JavaScriptWorks/foundao/ReactWeb/dh_h5/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/HeroMeiKong/JobSpace/JavaScriptWorks/foundao/ReactWeb/dh_h5/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/HeroMeiKong/JobSpace/JavaScriptWorks/foundao/ReactWeb/dh_h5/src/components/TalkingPoetry/index.js\";\nimport React, { Component } from 'react';\nimport $ from 'jquery';\nimport './index.scss';\nimport ListStyleSnd from '../ListStyleSnd/index';\n\nvar TalkingPoetry =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(TalkingPoetry, _Component);\n\n  function TalkingPoetry(props) {\n    var _this2;\n\n    _classCallCheck(this, TalkingPoetry);\n\n    _this2 = _possibleConstructorReturn(this, _getPrototypeOf(TalkingPoetry).call(this, props));\n\n    _this2.getParameter = function (url) {\n      var dataUrl = '';\n      var firstNav;\n\n      if (sessionStorage.firstNav) {\n        firstNav = JSON.parse(sessionStorage.firstNav);\n      } else {\n        _this2.props.history.push('/');\n\n        return false;\n      }\n\n      var firstNavList = firstNav.categoryList;\n      var pageUrl = url;\n\n      for (var i in firstNavList) {\n        if (pageUrl === firstNavList[i].sign) {\n          dataUrl = firstNavList[i].listUrl;\n        }\n      } // console.log(dataUrl);\n      // return\n\n\n      var pagelink = window.location.href;\n      var sign = '';\n\n      if (pagelink.indexOf('?type=') === -1) {\n        sign = '';\n      } else {\n        sign = pagelink.slice(pagelink.lastIndexOf('?type=') + 6);\n      }\n\n      _this2.setState({\n        dataUrl: dataUrl,\n        sign: sign\n      }, function () {\n        this.getData();\n      });\n    };\n\n    _this2.getData = function () {\n      var dataUrl = _this2.state.dataUrl;\n      $.ajax({\n        type: 'GET',\n        dataType: \"jsonp\",\n        url: 'http://m.app.cctv.com/json/jsonp?url=' + dataUrl + '&cb=getTalkData',\n        data: {}\n      });\n    };\n\n    _this2.getListData = function () {\n      var _this2$state = _this2.state,\n          sign = _this2$state.sign,\n          url = _this2$state.url,\n          talkList = _this2$state.talkList; // console.log(talkList)\n      // return;\n      // console.log(sign.length,'sign');\n\n      url = talkList[0].listUrl;\n\n      if (sign.length > 0) {\n        for (var i in talkList) {\n          if (sign === talkList[i].sign) {\n            url = talkList[i].listUrl;\n            break;\n          }\n        }\n      } else {\n        url = talkList[0].listUrl;\n      } // console.log(sign)\n\n\n      $.ajax({\n        url: 'http://m.app.cctv.com/json/jsonp?url=' + url + '&cb=TalkList',\n        dataType: 'jsonp',\n        type: 'GET'\n      });\n    };\n\n    _this2.changeSee = function (item) {\n      // console.log(this.props)\n      var pagelink = _this2.props.match.url;\n\n      _this2.props.history.push(pagelink + '?type=' + item.sign); // this.setState({\n      //   sign:item.sign,\n      //   ListData:[],\n      //   url:item.listUrl\n      // },()=> this.getListData())\n\n    };\n\n    _this2.state = {\n      dataUrl: '',\n      talkall: {},\n      talkList: [],\n      sign: '',\n      url: \"\",\n      ListData: []\n    };\n    return _this2;\n  }\n\n  _createClass(TalkingPoetry, [{\n    key: \"componentWillReceiveProps\",\n    value: function componentWillReceiveProps(nextProps, nextContext) {\n      // console.log(nextProps)\n      this.getParameter(nextProps.match.params.name);\n      this.setState({\n        // sign:'',\n        ListData: [] // url:''\n\n      });\n    }\n    /*获取数据接口*/\n\n  }, {\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      this.getParameter(this.props.match.params.name);\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps, prevState, snapshot) {\n      var tp = window.sessionStorage.getItem('top');\n      $(document).scrollTop(tp);\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this = this;\n\n      window.getTalkData = function (resp) {\n        // console.log(resp)\n        if (!resp) {\n          return;\n        }\n\n        _this.setState({\n          talkall: resp.data,\n          talkList: resp.data.categoryList || []\n        }, function () {\n          _this.getListData();\n        });\n      };\n\n      window.TalkList = function (resp) {\n        // console.log(resp)\n        _this.setState({\n          ListData: resp.data.itemList || []\n        });\n      };\n    }\n    /*获取页面数据*/\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var _this$state = this.state,\n          ListData = _this$state.ListData,\n          talkList = _this$state.talkList,\n          sign = _this$state.sign; // console.log(talkList,'talkList')\n\n      return React.createElement(\"div\", {\n        className: \"talking-box\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 141\n        },\n        __self: this\n      }, talkList.length > 1 ? React.createElement(\"ul\", {\n        className: \"talking-nav\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143\n        },\n        __self: this\n      }, talkList.map(function (item, index) {\n        return React.createElement(\"li\", {\n          className: sign === '' && index === 0 ? \"active\" : sign === item.sign ? 'active' : '',\n          key: 'tnav' + index,\n          onClick: _this3.changeSee.bind(_this3, item),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 145\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 146\n          },\n          __self: this\n        }, React.createElement(\"img\", {\n          src: item.imgUrl,\n          alt: item.title,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 147\n          },\n          __self: this\n        })), React.createElement(\"h2\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 149\n          },\n          __self: this\n        }, item.title));\n      })) : '', React.createElement(ListStyleSnd, {\n        data: ListData,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 155\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return TalkingPoetry;\n}(Component);\n\nexport { TalkingPoetry as default };","map":{"version":3,"sources":["/Users/HeroMeiKong/JobSpace/JavaScriptWorks/foundao/ReactWeb/dh_h5/src/components/TalkingPoetry/index.js"],"names":["React","Component","$","ListStyleSnd","TalkingPoetry","props","getParameter","url","dataUrl","firstNav","sessionStorage","JSON","parse","history","push","firstNavList","categoryList","pageUrl","i","sign","listUrl","pagelink","window","location","href","indexOf","slice","lastIndexOf","setState","getData","state","ajax","type","dataType","data","getListData","talkList","length","changeSee","item","match","talkall","ListData","nextProps","nextContext","params","name","prevProps","prevState","snapshot","tp","getItem","document","scrollTop","_this","getTalkData","resp","TalkList","itemList","map","index","bind","imgUrl","title"],"mappings":";;;;;;AAAA,OAAOA,KAAP,IAAeC,SAAf,QAA+B,OAA/B;AACA,OAAOC,CAAP,MAAc,QAAd;AACA,OAAO,cAAP;AACA,OAAOC,YAAP,MAAyB,uBAAzB;;IACqBC,a;;;;;AACnB,yBAAYC,KAAZ,EAAmB;AAAA;;AAAA;;AACjB,wFAAMA,KAAN;;AADiB,WAuBnBC,YAvBmB,GAuBJ,UAACC,GAAD,EAAO;AACpB,UAAIC,OAAO,GAAE,EAAb;AACA,UAAIC,QAAJ;;AACA,UAAGC,cAAc,CAACD,QAAlB,EAA2B;AACzBA,QAAAA,QAAQ,GAACE,IAAI,CAACC,KAAL,CAAWF,cAAc,CAACD,QAA1B,CAAT;AACD,OAFD,MAEM;AACJ,eAAKJ,KAAL,CAAWQ,OAAX,CAAmBC,IAAnB,CAAwB,GAAxB;;AACA,eAAO,KAAP;AACD;;AACD,UAAIC,YAAY,GAAGN,QAAQ,CAACO,YAA5B;AACA,UAAIC,OAAO,GAAGV,GAAd;;AACA,WAAK,IAAIW,CAAT,IAAcH,YAAd,EAA2B;AACzB,YAAIE,OAAO,KAAKF,YAAY,CAACG,CAAD,CAAZ,CAAgBC,IAAhC,EAAqC;AACjCX,UAAAA,OAAO,GAACO,YAAY,CAACG,CAAD,CAAZ,CAAgBE,OAAxB;AACH;AACF,OAfmB,CAgBpB;AACA;;;AACA,UAAIC,QAAQ,GAAGC,MAAM,CAACC,QAAP,CAAgBC,IAA/B;AACA,UAAIL,IAAI,GAAE,EAAV;;AACA,UAAIE,QAAQ,CAACI,OAAT,CAAiB,QAAjB,MAA6B,CAAC,CAAlC,EAAoC;AAClCN,QAAAA,IAAI,GAAC,EAAL;AACD,OAFD,MAEM;AACJA,QAAAA,IAAI,GAAGE,QAAQ,CAACK,KAAT,CAAeL,QAAQ,CAACM,WAAT,CAAqB,QAArB,IAA+B,CAA9C,CAAP;AACD;;AACD,aAAKC,QAAL,CAAc;AACZpB,QAAAA,OAAO,EAAPA,OADY;AAEZW,QAAAA,IAAI,EAAJA;AAFY,OAAd,EAGE,YAAY;AACZ,aAAKU,OAAL;AACD,OALD;AAMD,KAtDkB;;AAAA,WAsFnBA,OAtFmB,GAsFX,YAAI;AAAA,UACHrB,OADG,GACQ,OAAKsB,KADb,CACHtB,OADG;AAEVN,MAAAA,CAAC,CAAC6B,IAAF,CAAO;AACLC,QAAAA,IAAI,EAAC,KADA;AAELC,QAAAA,QAAQ,EAAE,OAFL;AAGL1B,QAAAA,GAAG,EAAC,0CAAwCC,OAAxC,GAAgD,iBAH/C;AAIL0B,QAAAA,IAAI,EAAC;AAJA,OAAP;AAMD,KA9FkB;;AAAA,WAiGnBC,WAjGmB,GAiGP,YAAI;AAAA,yBACgB,OAAKL,KADrB;AAAA,UACTX,IADS,gBACTA,IADS;AAAA,UACFZ,GADE,gBACFA,GADE;AAAA,UACI6B,QADJ,gBACIA,QADJ,EAEd;AACA;AACA;;AACA7B,MAAAA,GAAG,GAAG6B,QAAQ,CAAC,CAAD,CAAR,CAAYhB,OAAlB;;AACA,UAAGD,IAAI,CAACkB,MAAL,GAAY,CAAf,EAAiB;AACf,aAAK,IAAInB,CAAT,IAAckB,QAAd,EAAuB;AACrB,cAAIjB,IAAI,KAAGiB,QAAQ,CAAClB,CAAD,CAAR,CAAYC,IAAvB,EAA4B;AAC1BZ,YAAAA,GAAG,GAAG6B,QAAQ,CAAClB,CAAD,CAAR,CAAYE,OAAlB;AACA;AACD;AACF;AACF,OAPD,MAOM;AACJb,QAAAA,GAAG,GAAG6B,QAAQ,CAAC,CAAD,CAAR,CAAYhB,OAAlB;AACD,OAfa,CAgBd;;;AACAlB,MAAAA,CAAC,CAAC6B,IAAF,CAAO;AACLxB,QAAAA,GAAG,EAAC,0CAAwCA,GAAxC,GAA4C,cAD3C;AAEL0B,QAAAA,QAAQ,EAAC,OAFJ;AAGLD,QAAAA,IAAI,EAAC;AAHA,OAAP;AAKD,KAvHkB;;AAAA,WAyHnBM,SAzHmB,GAyHT,UAACC,IAAD,EAAQ;AAChB;AACA,UAAIlB,QAAQ,GAAG,OAAKhB,KAAL,CAAWmC,KAAX,CAAiBjC,GAAhC;;AACA,aAAKF,KAAL,CAAWQ,OAAX,CAAmBC,IAAnB,CAAwBO,QAAQ,GAAC,QAAT,GAAkBkB,IAAI,CAACpB,IAA/C,EAHgB,CAIhB;AACA;AACA;AACA;AACA;;AACD,KAlIkB;;AAEjB,WAAKW,KAAL,GAAa;AACXtB,MAAAA,OAAO,EAAC,EADG;AAEXiC,MAAAA,OAAO,EAAC,EAFG;AAGXL,MAAAA,QAAQ,EAAC,EAHE;AAIXjB,MAAAA,IAAI,EAAC,EAJM;AAKXZ,MAAAA,GAAG,EAAC,EALO;AAMXmC,MAAAA,QAAQ,EAAC;AANE,KAAb;AAFiB;AAUlB;;;;8CAEyBC,S,EAAWC,W,EAAa;AAChD;AACA,WAAKtC,YAAL,CAAkBqC,SAAS,CAACH,KAAV,CAAgBK,MAAhB,CAAuBC,IAAzC;AACA,WAAKlB,QAAL,CAAc;AACZ;AACAc,QAAAA,QAAQ,EAAC,EAFG,CAGZ;;AAHY,OAAd;AAKD;AAED;;;;yCAiCqB;AACnB,WAAKpC,YAAL,CAAkB,KAAKD,KAAL,CAAWmC,KAAX,CAAiBK,MAAjB,CAAwBC,IAA1C;AACD;;;uCACkBC,S,EAAWC,S,EAAWC,Q,EAAU;AACjD,UAAIC,EAAE,GAAG5B,MAAM,CAACZ,cAAP,CAAsByC,OAAtB,CAA8B,KAA9B,CAAT;AACAjD,MAAAA,CAAC,CAACkD,QAAD,CAAD,CAAYC,SAAZ,CAAsBH,EAAtB;AACD;;;wCACmB;AAElB,UAAII,KAAK,GAAC,IAAV;;AACAhC,MAAAA,MAAM,CAACiC,WAAP,GAAmB,UAACC,IAAD,EAAQ;AACzB;AACA,YAAI,CAACA,IAAL,EAAU;AACR;AACD;;AACDF,QAAAA,KAAK,CAAC1B,QAAN,CAAe;AACba,UAAAA,OAAO,EAACe,IAAI,CAACtB,IADA;AAEbE,UAAAA,QAAQ,EAACoB,IAAI,CAACtB,IAAL,CAAUlB,YAAV,IAAwB;AAFpB,SAAf,EAGE,YAAI;AACJsC,UAAAA,KAAK,CAACnB,WAAN;AACD,SALD;AAMD,OAXD;;AAYAb,MAAAA,MAAM,CAACmC,QAAP,GAAgB,UAAUD,IAAV,EAAgB;AAC9B;AACAF,QAAAA,KAAK,CAAC1B,QAAN,CAAe;AACbc,UAAAA,QAAQ,EAACc,IAAI,CAACtB,IAAL,CAAUwB,QAAV,IAAoB;AADhB,SAAf;AAGD,OALD;AAMD;AAED;;;;6BA8CS;AAAA;;AAAA,wBAC0B,KAAK5B,KAD/B;AAAA,UACAY,QADA,eACAA,QADA;AAAA,UACSN,QADT,eACSA,QADT;AAAA,UACkBjB,IADlB,eACkBA,IADlB,EAEP;;AACA,aACE;AAAK,QAAA,SAAS,EAAC,aAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACGiB,QAAQ,CAACC,MAAT,GAAgB,CAAhB,GACD;AAAI,QAAA,SAAS,EAAC,aAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACGD,QAAQ,CAACuB,GAAT,CAAa,UAACpB,IAAD,EAAMqB,KAAN,EAAc;AAC1B,eAAO;AAAI,UAAA,SAAS,EAAEzC,IAAI,KAAG,EAAP,IAAWyC,KAAK,KAAG,CAAnB,GAAqB,QAArB,GAA8BzC,IAAI,KAAKoB,IAAI,CAACpB,IAAd,GAAmB,QAAnB,GAA4B,EAAzE;AAA6E,UAAA,GAAG,EAAE,SAAOyC,KAAzF;AAAgG,UAAA,OAAO,EAAE,MAAI,CAACtB,SAAL,CAAeuB,IAAf,CAAoB,MAApB,EAAyBtB,IAAzB,CAAzG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACL;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACE;AAAK,UAAA,GAAG,EAAEA,IAAI,CAACuB,MAAf;AAAuB,UAAA,GAAG,EAAEvB,IAAI,CAACwB,KAAjC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UADF,CADK,EAIL;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAAKxB,IAAI,CAACwB,KAAV,CAJK,CAAP;AAMD,OAPA,CADH,CADC,GAWE,EAZL,EAcE,oBAAC,YAAD;AAAc,QAAA,IAAI,EAAErB,QAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAdF,CADF;AAkBD;;;;EAzJwCzC,S;;SAAtBG,a","sourcesContent":["import React, {Component} from 'react';\nimport $ from 'jquery';\nimport './index.scss'\nimport ListStyleSnd from '../ListStyleSnd/index'\nexport default class TalkingPoetry extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      dataUrl:'',\n      talkall:{},\n      talkList:[],\n      sign:'',\n      url:\"\",\n      ListData:[]\n    };\n  }\n\n  componentWillReceiveProps(nextProps, nextContext) {\n    // console.log(nextProps)\n    this.getParameter(nextProps.match.params.name);\n    this.setState({\n      // sign:'',\n      ListData:[],\n      // url:''\n    });\n  }\n\n  /*获取数据接口*/\n  getParameter = (url)=>{\n    let dataUrl ='';\n    let firstNav;\n    if(sessionStorage.firstNav){\n      firstNav=JSON.parse(sessionStorage.firstNav);\n    }else {\n      this.props.history.push('/');\n      return false\n    }\n    let firstNavList = firstNav.categoryList;\n    let pageUrl = url;\n    for (let i in firstNavList){\n      if (pageUrl === firstNavList[i].sign){\n          dataUrl=firstNavList[i].listUrl\n      }\n    }\n    // console.log(dataUrl);\n    // return\n    let pagelink = window.location.href;\n    let sign ='';\n    if (pagelink.indexOf('?type=')===-1){\n      sign=''\n    } else{\n      sign = pagelink.slice(pagelink.lastIndexOf('?type=')+6);\n    }\n    this.setState({\n      dataUrl,\n      sign\n    },function () {\n      this.getData();\n    })\n  };\n  componentWillMount() {\n    this.getParameter(this.props.match.params.name);\n  }\n  componentDidUpdate(prevProps, prevState, snapshot) {\n    let tp = window.sessionStorage.getItem('top');\n    $(document).scrollTop(tp)\n  }\n  componentDidMount() {\n\n    let _this=this;\n    window.getTalkData=(resp)=>{\n      // console.log(resp)\n      if (!resp){\n        return\n      }\n      _this.setState({\n        talkall:resp.data,\n        talkList:resp.data.categoryList||[]\n      },()=>{\n        _this.getListData();\n      })\n    }\n    window.TalkList=function (resp) {\n      // console.log(resp)\n      _this.setState({\n        ListData:resp.data.itemList||[]\n      })\n    }\n  }\n\n  /*获取页面数据*/\n  getData=()=>{\n    const {dataUrl} = this.state;\n    $.ajax({\n      type:'GET',\n      dataType: \"jsonp\",\n      url:'http://m.app.cctv.com/json/jsonp?url='+dataUrl+'&cb=getTalkData',\n      data:{},\n    })\n  };\n\n  /*请求列表数据*/\n  getListData=()=>{\n    let {sign , url , talkList} = this.state;\n    // console.log(talkList)\n    // return;\n    // console.log(sign.length,'sign');\n    url = talkList[0].listUrl;\n    if(sign.length>0){\n      for (let i in talkList){\n        if (sign===talkList[i].sign){\n          url = talkList[i].listUrl;\n          break;\n        }\n      }\n    }else {\n      url = talkList[0].listUrl\n    }\n    // console.log(sign)\n    $.ajax({\n      url:'http://m.app.cctv.com/json/jsonp?url='+url+'&cb=TalkList',\n      dataType:'jsonp',\n      type:'GET'\n    })\n  };\n  /*切换数据*/\n  changeSee=(item)=>{\n    // console.log(this.props)\n    let pagelink = this.props.match.url;\n    this.props.history.push(pagelink+'?type='+item.sign);\n    // this.setState({\n    //   sign:item.sign,\n    //   ListData:[],\n    //   url:item.listUrl\n    // },()=> this.getListData())\n  };\n  render() {\n    const {ListData,talkList,sign} = this.state;\n    // console.log(talkList,'talkList')\n    return (\n      <div className='talking-box'>\n        {talkList.length>1?\n        <ul className='talking-nav'>\n          {talkList.map((item,index)=>{\n            return <li className={sign===''&&index===0?\"active\":sign === item.sign?'active':''} key={'tnav'+index} onClick={this.changeSee.bind(this,item)}>\n              <div>\n                <img src={item.imgUrl} alt={item.title}/>\n              </div>\n              <h2>{item.title}</h2>\n            </li>\n          })}\n        </ul>\n          :''\n        }\n        <ListStyleSnd data={ListData}/>\n      </div>\n    )\n  }\n}"]},"metadata":{},"sourceType":"module"}