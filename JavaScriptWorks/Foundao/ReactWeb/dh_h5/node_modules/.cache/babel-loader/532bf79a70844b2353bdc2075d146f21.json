{"ast":null,"code":"import _classCallCheck from \"/Users/HeroMeiKong/JobSpace/JavaScriptWorks/foundao/ReactWeb/dh_h5/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/HeroMeiKong/JobSpace/JavaScriptWorks/foundao/ReactWeb/dh_h5/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/HeroMeiKong/JobSpace/JavaScriptWorks/foundao/ReactWeb/dh_h5/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/HeroMeiKong/JobSpace/JavaScriptWorks/foundao/ReactWeb/dh_h5/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/HeroMeiKong/JobSpace/JavaScriptWorks/foundao/ReactWeb/dh_h5/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/Users/HeroMeiKong/JobSpace/JavaScriptWorks/foundao/ReactWeb/dh_h5/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/Users/HeroMeiKong/JobSpace/JavaScriptWorks/foundao/ReactWeb/dh_h5/src/components/Recommend/LatestInformation/index.js\";\nimport React, { Component } from 'react';\nimport $ from 'jquery';\nimport { withRouter } from 'react-router-dom';\nimport './index.scss';\nimport tool from '../../../tool.js';\n\nvar Latest =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Latest, _Component);\n\n  function Latest(props) {\n    var _this2;\n\n    _classCallCheck(this, Latest);\n\n    _this2 = _possibleConstructorReturn(this, _getPrototypeOf(Latest).call(this, props));\n\n    _this2.getVideo = function () {\n      var _this = _assertThisInitialized(_assertThisInitialized(_this2));\n\n      var ti;\n      ti = setInterval(function () {\n        if (window.jQuery('#videoBox').find('video').get(0)) {\n          _this.setState({\n            iscreate: false\n          });\n\n          var videoDom = window.jQuery('#videoBox').find('video').get(0);\n          videoDom.setAttribute('webkit-playsinline', true);\n          videoDom.setAttribute('x-webkit-airplay', true);\n          videoDom.setAttribute('x5-playsinline', true);\n          document.addEventListener(\"WeixinJSBridgeReady\", function () {\n            // alert(41)\n            if (tool.is_iOS()) {\n              window.jQuery('#videoBox').find('video').get(0).play();\n            } else {}\n          }, false);\n          clearInterval(ti);\n          videoDom.addEventListener('ended', function () {\n            var _this$state = _this.state,\n                latestData = _this$state.latestData,\n                currIndex = _this$state.currIndex;\n\n            if (currIndex >= latestData.length) {\n              _this.setState({\n                currIndex: 0\n              });\n\n              _this.setVideo(latestData[0], 0);\n            } else {\n              _this.setState({\n                currIndex: currIndex + 1\n              });\n\n              _this.setVideo(latestData[currIndex + 1], currIndex + 1);\n            }\n          });\n        }\n      }, 100);\n    };\n\n    _this2.setVideo = function (item, index) {\n      _this2.setState({\n        cuurvid: item.vid,\n        currIndex: index,\n        iscreate: true\n      });\n\n      window.jQuery('#videoBox').html(''); // console.log(window.jQuery('#videoBox').html())\n      // return\n\n      var winw = window.innerWidth >= 750 ? 750 : window.innerWidth;\n      console.log(winw);\n      var w = 7.02 / 750 * winw;\n      var h = w * 0.58;\n\n      function creatMultiPlayerTest(divid, pid, isAutoPlay, posterImg) {\n        var fo = window.createCommonPlayer(divid, w, h, \"jiankang\", isAutoPlay, posterImg);\n\n        if (fo) {\n          fo.addVariable(\"id\", \"null\");\n          fo.addVariable(\"videoId\", \"VIDE100215108600\"); //视频集id\n\n          fo.addVariable(\"articleId\", \"\");\n          fo.addVariable(\"filePath\", \"\");\n          fo.addVariable(\"sysSource\", \"\"); //视频来源\n\n          fo.addVariable(\"channelId\", \"\");\n          fo.addVariable(\"url\", \"\"); //视频页面url，如http://tv.cntv.cn/video/C18472/a28126e5e0424a44af6a9bc4c5a47742\n\n          fo.addVariable(\"scheduleId\", \"\"); //关键字\n\n          fo.addVariable(\"videoCenterId\", pid); //视频生产中心guid (必要值)\n\n          fo.addVariable(\"isLogin\", \"\"); //用户中心相关\n\n          fo.addVariable(\"userId\", \"\"); //用户中心相关\n          // fo.addVariable(\"wideMode\", \"normal\");\n          // fo.addVariable(\"adCall\", \"\");\t//前贴片广告\n          // fo.addVariable(\"adAfter\",\"\");\t//后贴广告\n          // fo.addVariable(\"adPause\", \"\");\t//暂停广告\n          // fo.addVariable(\"adCorner\", \"\");\t//角标广告\n          // fo.addVariable(\"adCurtain\", \"\");//跑马灯广告\n          // fo.addVariable(\"preImage\", \"http://p1.img.cctvpic.com/photoAlbum/page/performance/img/2018/11/27/1543284226918_68.jpg\");//默认图片\n          // fo.addVariable(\"isAutoPlay\", true);//是否自动播放\n          //fo.addVariable(\"isDefaultPreImage\", \"true\");//是否默认从vdn取图，非自动播放情况下才有效\n          // fo.addParam(\"wmode\", \"opaque\");\n\n          window.writePlayer(fo, divid);\n        }\n      }\n\n      if (tool.is_iOS()) {\n        creatMultiPlayerTest(\"videoBox\", item.vid, false, item.imgUrl);\n      } else {\n        creatMultiPlayerTest(\"videoBox\", item.vid, false, item.imgUrl);\n      }\n\n      _this2.getVideo();\n    };\n\n    _this2.getLatest = function () {\n      var data = _this2.state.data;\n\n      if (!data) {\n        return;\n      }\n\n      var latestUrl = data.templateUrl;\n      $.ajax({\n        url: 'http://m.app.cctv.com/json/jsonp?url=' + latestUrl + '&cb=LatestData',\n        dataType: 'jsonp',\n        type: 'GET'\n      });\n    };\n\n    _this2.changeVideo = function (item, index) {\n      var iscreate = _this2.state.iscreate;\n\n      if (iscreate) {\n        alert('视频正在赶来的路上，请不要切换太快！');\n        return false;\n      }\n\n      _this2.setState({\n        curVsetId: item.vsetId,\n        curvid: item.vid\n      });\n\n      _this2.setVideo(item, index);\n    };\n\n    _this2.changeaudio = function () {\n      var videoSound = window.jQuery('#videoBox').find('video').get(0).muted; // console.log(videoSound)\n\n      if (videoSound) {\n        window.jQuery('#videoBox').find('video').get(0).muted = false;\n\n        _this2.setState({\n          soundState: false\n        });\n      } else {\n        window.jQuery('#videoBox').find('video').get(0).muted = true;\n\n        _this2.setState({\n          soundState: true\n        });\n      }\n    };\n\n    _this2.changeLink = function (data) {\n      var firstNav;\n\n      if (sessionStorage.firstNav) {\n        firstNav = JSON.parse(sessionStorage.firstNav);\n      } else {\n        _this2.props.history.push('/');\n\n        return false;\n      }\n\n      var PageLink = '/';\n      var firstNavList = firstNav.categoryList;\n      var dataSign = data.categorySign,\n          categoryCid = data.categoryCid;\n\n      for (var i in firstNavList) {\n        if (dataSign === firstNavList[i].sign) {\n          var category = firstNavList[i].category;\n\n          if (category / 1 === 1) {\n            PageLink = '/';\n          } else if (category / 1 === 2) {\n            PageLink = '/talkingPoetry/' + dataSign + '?type=' + categoryCid;\n          } else if (category / 1 === 3) {\n            PageLink = '/lookPoetry/' + dataSign + '?type=' + categoryCid;\n          } else if (category / 1 === 4) {\n            PageLink = '/lookPoetry2/' + dataSign + '?type=' + categoryCid;\n          } else if (category / 1 === 5) {\n            PageLink = '/PopularityList/' + dataSign;\n          }\n\n          break;\n        }\n      }\n\n      _this2.props.history.push(PageLink);\n    };\n\n    _this2.state = {\n      data: {},\n      //推荐页所有数据\n      latestall: {},\n      latestData: [],\n      cuurvid: \"\",\n      soundState: false,\n      curVsetId: \"\",\n      curvid: \"\",\n      iscreate: false,\n      currIndex: 0\n    };\n    return _this2;\n  }\n\n  _createClass(Latest, [{\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      var data = this.props.data;\n      this.setState({\n        data: data\n      });\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this = this;\n\n      window.LatestData = function (resp) {\n        var latestData = [];\n\n        for (var i in resp.data.itemList) {\n          if (resp.data.itemList[i].isShow === '0') {\n            return;\n          } else {\n            latestData.push(resp.data.itemList[i]);\n          }\n        }\n\n        _this.setState({\n          latestall: resp.data,\n          latestData: latestData,\n          curVsetId: latestData[0].vsetId,\n          curvid: latestData[0].vid,\n          currIndex: 0\n        }, function () {\n          var latestData = this.state.latestData;\n\n          _this.setVideo(latestData[0], 0);\n        });\n      };\n\n      this.getLatest(); // this.getVideo()\n    }\n    /*video创建完成*/\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var _this$state2 = this.state,\n          data = _this$state2.data,\n          latestData = _this$state2.latestData,\n          curVsetId = _this$state2.curVsetId,\n          curvid = _this$state2.curvid,\n          cuurvid = _this$state2.cuurvid,\n          soundState = _this$state2.soundState; // console.log(curvid);\n\n      if (data.showControl / 1 === 1) {\n        return React.createElement(\"div\", {\n          className: \"Latest-box\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 220\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 221\n          },\n          __self: this\n        }, React.createElement(\"h2\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 222\n          },\n          __self: this\n        }, data.title, data.categoryControl / 1 === 1 ? React.createElement(\"a\", {\n          onClick: this.changeLink.bind(this, data),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 225\n          },\n          __self: this\n        }, \"more\") : \"\"), curVsetId.length > 0 ? React.createElement(\"a\", {\n          className: \"seewhole\",\n          href: \"http://app.cctv.com/special/cbox/detail/index.html?guid=\" + curvid + \"&mid=17aQfAjy0815&vsid=\" + curVsetId,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 230\n          },\n          __self: this\n        }, \"\\u770B\\u6574\\u671F\") : \"\", React.createElement(\"div\", {\n          id: \"videoBox\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 232\n          },\n          __self: this\n        })), React.createElement(\"ul\", {\n          className: \"LatestVideoList\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 235\n          },\n          __self: this\n        }, latestData.map(function (item, index) {\n          return React.createElement(\"li\", {\n            key: 'video' + index,\n            className: cuurvid === item.vid ? \"active\" : \"\",\n            onClick: _this3.changeVideo.bind(_this3, item, index),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 238\n            },\n            __self: this\n          }, React.createElement(\"div\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 240\n            },\n            __self: this\n          }, React.createElement(\"img\", {\n            src: item.imgUrl,\n            alt: item.title,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 241\n            },\n            __self: this\n          }), item.video_length ? React.createElement(\"p\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 243\n            },\n            __self: this\n          }, item.video_length) : \"\"), React.createElement(\"h3\", {\n            className: \"\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 247\n            },\n            __self: this\n          }, item.title));\n        })));\n      }\n    }\n  }]);\n\n  return Latest;\n}(Component);\n\nexport default withRouter(Latest);","map":{"version":3,"sources":["/Users/HeroMeiKong/JobSpace/JavaScriptWorks/foundao/ReactWeb/dh_h5/src/components/Recommend/LatestInformation/index.js"],"names":["React","Component","$","withRouter","tool","Latest","props","getVideo","_this","ti","setInterval","window","jQuery","find","get","setState","iscreate","videoDom","setAttribute","document","addEventListener","is_iOS","play","clearInterval","state","latestData","currIndex","length","setVideo","item","index","cuurvid","vid","html","winw","innerWidth","console","log","w","h","creatMultiPlayerTest","divid","pid","isAutoPlay","posterImg","fo","createCommonPlayer","addVariable","writePlayer","imgUrl","getLatest","data","latestUrl","templateUrl","ajax","url","dataType","type","changeVideo","alert","curVsetId","vsetId","curvid","changeaudio","videoSound","muted","soundState","changeLink","firstNav","sessionStorage","JSON","parse","history","push","PageLink","firstNavList","categoryList","dataSign","categorySign","categoryCid","i","sign","category","latestall","LatestData","resp","itemList","isShow","showControl","title","categoryControl","bind","map","video_length"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\nimport $ from 'jquery';\nimport {withRouter} from 'react-router-dom'\nimport './index.scss';\nimport tool from '../../../tool.js'\nclass Latest extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      data:{},//推荐页所有数据\n      latestall:{},\n      latestData:[],\n      cuurvid:\"\",\n      soundState:false,\n      curVsetId:\"\",\n      curvid:\"\",\n      iscreate:false,\n      currIndex:0\n    };\n  }\n\n  componentWillMount() {\n    const {data} = this.props;\n    this.setState({\n      data\n    })\n  }\n  componentDidMount() {\n    let _this = this;\n    window.LatestData=function (resp) {\n      let latestData = [];\n      for (let i in resp.data.itemList) {\n        if(resp.data.itemList[i].isShow==='0'){\n          return\n        }else {\n          latestData.push(resp.data.itemList[i])\n        }\n      }\n      _this.setState({\n        latestall:resp.data,\n        latestData:latestData,\n        curVsetId:latestData[0].vsetId,\n        curvid:latestData[0].vid,\n        currIndex:0\n      },function () {\n        const {latestData} = this.state;\n        _this.setVideo(latestData[0],0);\n      })\n    };\n    this.getLatest();\n    // this.getVideo()\n  }\n\n  /*video创建完成*/\n  getVideo=()=>{\n    let _this = this;\n    let ti;\n    ti = setInterval(function () {\n      if (window.jQuery('#videoBox').find('video').get(0)){\n        _this.setState({\n          iscreate:false\n        });\n        let videoDom = window.jQuery('#videoBox').find('video').get(0);\n        videoDom.setAttribute('webkit-playsinline',true);\n        videoDom.setAttribute('x-webkit-airplay',true);\n        videoDom.setAttribute('x5-playsinline',true);\n        document.addEventListener(\"WeixinJSBridgeReady\", function () {\n          // alert(41)\n          if (tool.is_iOS()){\n            window.jQuery('#videoBox').find('video').get(0).play();\n          }else {\n          }\n\n        }, false);\n        clearInterval(ti);\n        videoDom.addEventListener('ended',function () {\n          const { latestData , currIndex} = _this.state;\n          if (currIndex >= latestData.length){\n            _this.setState({\n              currIndex:0\n            });\n            _this.setVideo(latestData[0],0)\n          }else {\n            _this.setState({\n              currIndex:currIndex+1\n            })\n            _this.setVideo(latestData[currIndex+1],currIndex+1);\n          }\n        });\n      }\n    },100)\n  }\n  setVideo=(item,index)=>{\n    this.setState({\n      cuurvid:item.vid,\n      currIndex:index,\n      iscreate:true\n    });\n    window.jQuery('#videoBox').html('');\n    // console.log(window.jQuery('#videoBox').html())\n    // return\n    let winw= window.innerWidth>=750?750:window.innerWidth;\n    console.log(winw)\n    let w =(7.02 / 750)*winw;\n    let h =w*0.58;\n    function creatMultiPlayerTest(divid, pid, isAutoPlay, posterImg){\n      let fo = window.createCommonPlayer(divid,w,h,\"jiankang\", isAutoPlay, posterImg);\n      if (fo){\n        fo.addVariable(\"id\", \"null\");\n        fo.addVariable(\"videoId\", \"VIDE100215108600\");  //视频集id\n        fo.addVariable(\"articleId\", \"\");\n        fo.addVariable(\"filePath\", \"\");\n        fo.addVariable(\"sysSource\", \"\");//视频来源\n        fo.addVariable(\"channelId\", \"\");\n        fo.addVariable(\"url\", \"\");//视频页面url，如http://tv.cntv.cn/video/C18472/a28126e5e0424a44af6a9bc4c5a47742\n        fo.addVariable(\"scheduleId\", \"\");//关键字\n        fo.addVariable(\"videoCenterId\",pid); //视频生产中心guid (必要值)\n        fo.addVariable(\"isLogin\", \"\");//用户中心相关\n        fo.addVariable(\"userId\", \"\");//用户中心相关\n        // fo.addVariable(\"wideMode\", \"normal\");\n        // fo.addVariable(\"adCall\", \"\");\t//前贴片广告\n        // fo.addVariable(\"adAfter\",\"\");\t//后贴广告\n        // fo.addVariable(\"adPause\", \"\");\t//暂停广告\n        // fo.addVariable(\"adCorner\", \"\");\t//角标广告\n        // fo.addVariable(\"adCurtain\", \"\");//跑马灯广告\n        // fo.addVariable(\"preImage\", \"http://p1.img.cctvpic.com/photoAlbum/page/performance/img/2018/11/27/1543284226918_68.jpg\");//默认图片\n        // fo.addVariable(\"isAutoPlay\", true);//是否自动播放\n        //fo.addVariable(\"isDefaultPreImage\", \"true\");//是否默认从vdn取图，非自动播放情况下才有效\n        // fo.addParam(\"wmode\", \"opaque\");\n        window.writePlayer(fo,divid);\n      }\n\n    }\n    if (tool.is_iOS()){\n      creatMultiPlayerTest(\"videoBox\", item.vid, false, item.imgUrl);\n    }else {\n      creatMultiPlayerTest(\"videoBox\", item.vid, false, item.imgUrl);\n    }\n    this.getVideo();\n  };\n  getLatest=()=>{\n    const {data}=this.state;\n    if(!data){\n      return\n    }\n    let latestUrl = data.templateUrl;\n    $.ajax({\n      url:'http://m.app.cctv.com/json/jsonp?url='+latestUrl+'&cb=LatestData',\n      dataType:'jsonp',\n      type:'GET'\n    })\n  };\n  /*切换视频*/\n  changeVideo=(item,index)=>{\n    const {iscreate} = this.state\n    if (iscreate){\n      alert('视频正在赶来的路上，请不要切换太快！');\n      return false\n    }\n    this.setState({\n      curVsetId:item.vsetId,\n      curvid:item.vid\n    });\n    this.setVideo(item,index)\n  };\n  /*声音切换*/\n  changeaudio=()=>{\n    let videoSound=window.jQuery('#videoBox').find('video').get(0).muted;\n    // console.log(videoSound)\n    if (videoSound){\n      window.jQuery('#videoBox').find('video').get(0).muted=false;\n      this.setState({\n        soundState:false\n      });\n    } else {\n      window.jQuery('#videoBox').find('video').get(0).muted=true;\n      this.setState({\n        soundState:true\n      });\n    }\n  };\n\n  /*切换路由*/\n  changeLink=(data)=>{\n    let firstNav;\n    if(sessionStorage.firstNav){\n      firstNav=JSON.parse(sessionStorage.firstNav);\n    }else {\n      this.props.history.push('/');\n      return false\n    }\n    let PageLink ='/';\n    let firstNavList = firstNav.categoryList;\n    let dataSign = data.categorySign ,categoryCid = data.categoryCid;\n    for (let i in firstNavList){\n      if (dataSign===firstNavList[i].sign){\n        let category = firstNavList[i].category;\n         if (category/1===1){\n           PageLink='/'\n         }  else if (category/1===2){\n           PageLink='/talkingPoetry/'+dataSign+'?type='+categoryCid\n         }  else if (category/1===3){\n           PageLink='/lookPoetry/'+dataSign+'?type='+categoryCid\n         }  else if (category/1===4){\n           PageLink='/lookPoetry2/'+dataSign+'?type='+categoryCid\n         }  else if (category/1===5){\n           PageLink='/PopularityList/'+dataSign\n         }\n        break;\n      }\n    }\n    this.props.history.push(PageLink);\n  };\n\n  render() {\n    const {data,latestData , curVsetId , curvid ,cuurvid ,soundState} = this.state;\n    // console.log(curvid);\n    if(data.showControl/1===1){\n      return (\n        <div className='Latest-box'>\n          <div>\n            <h2>\n              {data.title}\n              {data.categoryControl/1===1?\n                <a onClick={this.changeLink.bind(this,data)}>more</a>\n                :\n                \"\"}\n            </h2>\n            {curVsetId.length>0?\n              <a className='seewhole' href={\"http://app.cctv.com/special/cbox/detail/index.html?guid=\"+curvid+\"&mid=17aQfAjy0815&vsid=\"+curVsetId}>看整期</a>\n              :\"\"}\n            <div id='videoBox'></div>\n            {/*<a href=\"javascript:;\" onClick={this.changeaudio} className={soundState ?\"active videoSY\":\"videoSY\"}>声音</a>*/}\n          </div>\n          <ul className='LatestVideoList'>\n            {\n              latestData.map((item,index)=>{\n                return <li key={'video'+index} className={cuurvid === item.vid ?\"active\":\"\"}\n                           onClick={this.changeVideo.bind(this,item,index)}>\n                  <div>\n                    <img src={item.imgUrl} alt={item.title}/>\n                    {item.video_length?\n                      <p>{item.video_length}</p>\n                      :\"\"\n                    }\n                  </div>\n                  <h3 className=''>{item.title}</h3>\n                </li>\n              })\n            }\n          </ul>\n        </div>\n      )\n    }\n\n  }\n}\nexport default withRouter(Latest)"]},"metadata":{},"sourceType":"module"}